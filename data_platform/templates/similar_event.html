{% load static %}
{% include "head.html" %}

<br /><br /><br /><br />
<form action="" style="margin-top: 15px;">
  <label>请输入要查询的事件：</label>
  <input type="text" id="input_event">
<!--  form表单中默认button类型是submit，点击后先走Ajax，然后显示表单提交后的结果，需要把button类型改为button-->
  <button type="button" id='event_search'>查询</button>
</form>
<p>推荐的相似故障：</p>
<table id="output_event" class="ui striped table" >
  <thead>
  <tr>
    <th>相似度</th>
    <th>问题描述</th>
    <th>ATA</th>
    <th>纠正措施</th>
    <th>排故措施</th>
  </tr>
  </thead>
  <tbody>
  </tbody>
</table>

<br><br><br><br><br><br><br><br><br><br><br><br>

{% include "foot.html" %}

<script type="text/javascript">
    
$(document).ready(function(){
    var urlparam = "{% url 'data_platform:similar_event' %}";
    $("#event_search").click(function(){
      $.post(urlparam,
      {
        input_event:$("#input_event").val()
        //jQuery获取select标签选中的option中的文本。把val()替换text()获取value值
      },
      function(data){
          $('#output_event').dataTable().fnClearTable();//清除表中原始的内容
          $("#output_event").dataTable().fnDestroy();//在每次初始化之前destroy之前的初始化内容
          var t = $("#output_event").DataTable({
            dom:"t",
            "bAutoWidth": false,
            "columnDefs": [{ "width": "10%", "targets":[0,2,3]} ] 
          });
          t.row.add([data[0][0],data[0][1],data[0][2],data[0][3],data[0][4]]).draw();
          t.row.add([data[1][0],data[1][1],data[1][2],data[1][3],data[1][4]]).draw();
          t.row.add([data[2][0],data[2][1],data[2][2],data[2][3],data[2][4]]).draw();
      });
    });  
})

</script>

